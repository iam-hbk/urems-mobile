"use client";

import { useState } from "react";
import { useForm, Controller, useFieldArray } from "react-hook-form";
import { zodResolver } from "@hookform/resolvers/zod";
import * as z from "zod";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { Button } from "@/components/ui/button";
import {
  Form,
  FormControl,
  FormDescription,
  FormField,
  FormItem,
  FormLabel,
} from "@/components/ui/form";
import { toast } from "sonner";
import { InjurySchema, InjuryType } from "@/interfaces/prf-schema";
import { Loader2, PlusCircleIcon, Trash2, X } from "lucide-react";
import { usePathname, useRouter } from "next/navigation";
import { useStore } from "@/lib/store";
import { useUpdatePrf } from "@/hooks/prf/useUpdatePrf";
import { PRF_FORM } from "@/interfaces/prf-form";
import { RadioGroup, RadioGroupItem } from "../ui/radio-group";
import { Label } from "../ui/label";
import { Alert, AlertDescription, AlertTitle } from "../ui/alert";

type Mark = InjuryType["injuries"][0];
const SYMBOLS = {
  DISLOCATION: "M1 13L5.75472 1L10 13L14.7547 1L19 13", // Crossed lines resembling a zigzag "M 0 0 L 10 10 M 10 0 L 0 10".
  FRACTURE:
    "M0.6871 6.69818H12.3678M0 10.9718H11.6807M4.8097 1L3.4355 16.67M9.6194 1L8.2452 16.67", // A straight horizontal line.
  OPEN_FRACTURE:
    "M6.68706 11.6982H18.3678M5.99996 15.9718H17.6807M10.8097 6L9.43546 21.67M15.6194 6L14.2452 21.67M13.5 0.999997C20.0016 1.563 24.3949 7.486 24 14C23.6319 20.0703 19.5583 24.9712 13.5 25.5C6.89192 26.0768 1.40597 20.6207 0.999959 14C0.56886 6.97022 6.48323 0.392388 13.5 0.999997Z", // A crossed diagonal line within a circle.
  GSW: "M3.00085 16.722C-0.333615 13.0314 -0.333615 7.39856 3.00085 3.70795L9.50789 10.215L3.00085 16.722ZM10.215 9.50789L3.70795 3.00085C7.39856 -0.333615 13.0314 -0.333615 16.722 3.00085L10.215 9.50789ZM3.70795 17.4292L10.215 10.9221L16.722 17.4292C13.0314 20.7636 7.39856 20.7636 3.70795 17.4292ZM17.4292 16.722L10.9221 10.215L17.4292 3.70795C20.7636 7.39856 20.7636 13.0314 17.4292 16.722Z",
  STAB_WOUND:
    "M4.13232 17.8714C0.456956 14.196 0.342085 8.30847 3.78771 4.49482L10.6483 11.3554L17.5089 18.216C13.6953 21.6616 7.80769 21.5468 4.13232 17.8714ZM18.216 17.5089L11.3554 10.6483L4.49482 3.78771C8.30847 0.342085 14.196 0.456956 17.8714 4.13232C21.5468 7.80769 21.6616 13.6953 18.216 17.5089Z", // A simple cross shape.
  LACERATION: "M1 22L10 1",
  ABRASION: "M6 22L15 1M11 22L20 1M16 22L25 1M21 22L30 1M1 22L10 1",
  BURNS:
    "M10 21.5L1.5 1M1.5 21.5L10 1M22 21.5L17.75 11.25M17.75 11.25L13.5 1M17.75 11.25L13.5 21.5M17.75 11.25L22 1M34 21.5L29.75 11.25M29.75 11.25L25.5 1M29.75 11.25L25.5 21.5M29.75 11.25L34 1", // A wavy, flame-like pattern.
  HAEMATOMA:
    "M5.3536 24.6465C0.0260137 19.3189 0.0260137 10.6812 5.3536 5.3536C10.6812 0.0260137 19.3189 0.0260137 24.6465 5.3536C29.9741 10.6812 29.9741 19.3189 24.6465 24.6465C19.3189 29.9741 10.6812 29.9741 5.3536 24.6465Z", // A filled circle (solid dot).
  BRUISE: "M19.5 19.5H0.5V0.5H19.5V19.5Z", // A solid square.
};

export default function BodyDiagram() {
  const prfId = usePathname().split("/")[2];
  const prf_from_store = useStore((state) => state.prfForms).find(
    (prf) => prf.prfFormId == prfId,
  );

  const updatePrfQuery = useUpdatePrf();
  const router = useRouter();

  const [selectedInjuryPreview, setSelectedInjuryPreview] = useState<Mark>();
  const [currentInjurySymbol, setCurrentInjurySymbol] = useState<string>(
    SYMBOLS.DISLOCATION,
  );
  const form = useForm<InjuryType>({
    resolver: zodResolver(InjurySchema),
    defaultValues: {
      injuries: prf_from_store?.prfData?.injuries?.data.injuries || [],
    },
  });
  const {
    fields: injuries,
    append: addInjury,
    remove: removeInjury,
  } = useFieldArray({
    control: form.control,
    name: "injuries",
  });

  const onSubmit = (values: InjuryType) => {
    const prfUpdateValue: PRF_FORM = {
      prfFormId: prfId,
      prfData: {
        ...prf_from_store?.prfData,
        injuries: {
          data: values,
          isCompleted: true,
          isOptional: false,
        },
      },
    };
    console.log("Submitting ->", prfUpdateValue);

    // updatePrfQuery.mutate(prfUpdateValue, {
    //   onSuccess: (data) => {
    //     toast.success("Diagnosis Information Updated", {
    //       duration: 3000,
    //       position: "top-right",
    //     });
    //     router.push(`/edit-prf/${data?.prfFormId}`);
    //   },
    //   onError: (error) => {
    //     toast.error("An error occurred", {
    //       duration: 3000,
    //       position: "top-right",
    //     });
    //   },
    // });
  };

  const handlePreviewInjury = (injury: Mark) => {
    if (selectedInjuryPreview === injury) {
      setSelectedInjuryPreview(undefined);
    } else {
      setSelectedInjuryPreview(injury);
    }
  };
  const handleClick = (event: React.MouseEvent<SVGSVGElement>) => {
    console.log("SVG Clicked ->", currentInjurySymbol);
    const svg = event.currentTarget;
    const point = svg.createSVGPoint();
    point.x = event.clientX;
    point.y = event.clientY;
    const svgPoint = point.matrixTransform(svg.getScreenCTM()?.inverse());
    addInjury({
      id: injuries.length,
      symbol: currentInjurySymbol,
      x: svgPoint.x,
      y: svgPoint.y,
    });
    setSelectedInjuryPreview(undefined);
  };
  const handleSymbolClick = (
    id: number,
    event?: React.MouseEvent<SVGGElement>,
  ) => {
    if (event) event.stopPropagation(); // Prevent triggering handleClick on the SVG
    //Get index of the injury to be removed
    const index = injuries.findIndex((injury) => injury.id === id);
    handlePreviewInjury(injuries[index]);
  };
  const handleRemoveInjury = (
    id: number,
    event?: React.MouseEvent<SVGGElement>,
  ) => {
    if (event) event.stopPropagation(); // Prevent triggering handleClick on the SVG
    const index = injuries.findIndex((injury) => injury.id === id);
    removeInjury(index);
    toast.success("Injury removed");
  };

  return (
    <div className="flex flex-col items-center space-y-4">
      <h3 className="scroll-m-20 self-start text-2xl font-semibold tracking-tight">
        Injuries
      </h3>
      <div className="flex w-full flex-row items-start justify-between">
        <div className="flex flex-col">
          <p className="text-sm text-muted-foreground">
            Select the injury symbol to add
          </p>
          <RadioGroup
            onValueChange={(value) => setCurrentInjurySymbol(value)}
            defaultValue={SYMBOLS.DISLOCATION}
            className="grid grid-cols-2 p-3"
          >
            {Object.entries(SYMBOLS).map((symbol) => {
              return (
                <Label
                  htmlFor={symbol[1]}
                  className="flex cursor-pointer items-center space-x-2 rounded border p-1"
                >
                  <RadioGroupItem value={symbol[1]} id={symbol[1]} />
                  <Label
                    className="flex cursor-pointer flex-row-reverse items-center justify-center gap-3 capitalize"
                    htmlFor={symbol[1]}
                  >
                    <svg
                      className="h-6 w-6"
                      viewBox="0 0 40 30"
                      fill="none"
                      xmlns="http://www.w3.org/2000/svg"
                    >
                      <g
                        key={symbol[1].repeat(2)}
                        // transform={`translate(${injury.x - 5}, ${injury.y - 5})`}
                        // onClick={(e) => handleSymbolClick(injury.id, e)}
                      >
                        <path
                          d={symbol[1]}
                          stroke="black"
                          strokeWidth="2"
                          fill={
                            symbol[0] === "HAEMATOMA" || symbol[0] === "BRUISE"
                              ? "black"
                              : "none"
                          }
                        />
                      </g>
                    </svg>
                    {symbol[0].toLowerCase().replace(/_/g, " ")}
                  </Label>
                </Label>
              );
            })}
          </RadioGroup>
        </div>
        <div className="flex min-w-52 flex-col rounded-md border p-2">
          <h4 className="mb-2 scroll-m-20 self-end text-xl font-semibold tracking-tight">
            Injury List
          </h4>
          <div className="space grid grid-cols-2 gap-3">
            {injuries.map((injury) => {
              return (
                <div
                  onMouseEnter={(e) => handlePreviewInjury(injury)}
                  onMouseLeave={() => setSelectedInjuryPreview(undefined)}
                  className="relative flex cursor-pointer flex-row items-center justify-between space-x-2 rounded border p-2 text-start capitalize transition-colors duration-200"
                >
                  {Object.keys(SYMBOLS)
                    .find(
                      (key) =>
                        SYMBOLS[key as keyof typeof SYMBOLS] === injury.symbol,
                    )
                    ?.toLowerCase()
                    .replace(/_/g, " ")}
                  {selectedInjuryPreview?.id === injury.id && (
                    <Button
                      onClick={(e) => handleRemoveInjury(injury.id)}
                      variant={"outline"}
                      className="absolute right-[-12px] top-[-18px] h-8 w-8 rounded-full p-2 text-destructive"
                    >
                      <Trash2 className="h-full w-full text-destructive" />
                    </Button>
                  )}
                </div>
              );
            })}
            {injuries.length === 0 && (
              <p className="col-span-full flex max-w-xs flex-row px-6 text-sm text-muted-foreground">
                <span>
                  <PlusCircleIcon className="mr-2 inline-block h-6 w-6" />
                </span>
                <span>
                  Select an injury symbol and click on the body diagram. The
                  selected injury will be added to this list.
                </span>
              </p>
            )}
          </div>
        </div>
      </div>
      <svg
        width="177"
        height="537"
        viewBox="0 0 177 537"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
        onClick={handleClick}
      >
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M126.249 131.973C125.31 133.477 125.224 136.03 125.903 142.221C126.4 146.756 126.875 166.887 126.959 186.958C127.11 223.309 127.49 230.948 129.147 230.948C129.627 230.948 130.019 234.097 130.019 237.946C130.019 241.945 130.448 244.945 131.019 244.945C131.669 244.945 132.019 258.774 132.019 284.436C132.019 310.097 131.669 323.927 131.019 323.927C130.442 323.927 130.019 327.065 130.019 331.342C130.019 335.675 129.579 338.903 128.959 339.11C128.376 339.304 127.635 342.955 127.313 347.223C126.99 351.491 126.342 355.221 125.872 355.511C125.403 355.8 125.019 358.71 125.019 361.977C125.019 365.27 124.573 367.917 124.019 367.917C123.397 367.917 123.019 373.546 123.019 382.806C123.019 394.92 122.747 397.8 121.563 398.255C120.39 398.705 120.012 402.275 119.618 416.608C119.348 426.394 118.668 439.351 118.105 445.399C117.543 451.448 116.796 460.671 116.445 465.895C116.084 471.265 115.31 475.702 114.663 476.105C113.98 476.53 113.382 480.591 113.178 486.19C112.903 493.749 113.145 495.871 114.428 497.153C115.303 498.028 116.019 500.126 116.019 501.815C116.019 503.504 116.397 504.886 116.859 504.886C117.321 504.886 118.293 506.685 119.019 508.885C119.745 511.084 120.942 512.884 121.679 512.884C122.416 512.884 123.019 513.559 123.019 514.384C123.019 515.208 123.367 515.883 123.792 515.883C124.217 515.883 125.412 517.458 126.449 519.382C127.486 521.307 128.938 522.882 129.676 522.882C130.415 522.882 131.019 523.332 131.019 523.881C131.019 524.431 131.694 524.881 132.519 524.881C133.452 524.881 134.019 525.825 134.019 527.381C134.019 529.504 133.557 529.88 130.948 529.88C129.258 529.88 127.201 530.555 126.376 531.38C124.232 533.523 111.019 533.523 111.019 531.38C111.019 530.547 110.13 529.88 109.019 529.88C107.919 529.88 107.019 529.43 107.019 528.88C107.019 528.33 106.344 527.88 105.519 527.88C104.694 527.88 104.019 527.206 104.019 526.381C104.019 525.548 103.13 524.881 102.019 524.881C100.919 524.881 100.019 524.431 100.019 523.881C100.019 523.332 98.894 522.882 97.519 522.882C95.963 522.882 95.019 522.315 95.019 521.382C95.019 520.557 94.569 519.882 94.019 519.882C93.469 519.882 93.019 518.308 93.019 516.383C93.019 514.459 93.469 512.884 94.019 512.884C94.665 512.884 95.019 501.22 95.019 479.891C95.019 458.563 94.665 446.899 94.019 446.899C93.388 446.899 93.019 440.067 93.019 428.403C93.019 416.739 93.388 409.907 94.019 409.907C94.648 409.907 95.019 403.409 95.019 392.411C95.019 381.414 94.648 374.915 94.019 374.915C93.38 374.915 93.019 366.084 93.019 350.421C93.019 334.757 92.658 325.926 92.019 325.926C91.463 325.926 91.019 323.26 91.019 319.928V313.929H88.003C83.674 313.929 77.019 311.661 77.019 310.187C77.019 309.495 76.537 308.93 75.948 308.93C74.563 308.93 72.019 306.387 72.019 305.002C72.019 304.413 71.569 303.931 71.019 303.931C70.469 303.931 70.019 303.058 70.019 301.991C70.019 300.923 69.569 299.772 69.019 299.432C67.784 298.669 67.69 285.555 68.902 283.172C69.388 282.217 70.401 280.087 71.152 278.437C72.781 274.863 74.47 272.938 75.979 272.938C76.586 272.938 77.341 272.263 77.657 271.439C77.985 270.584 79.477 269.939 81.126 269.939C82.717 269.939 84.019 269.489 84.019 268.939C84.019 268.389 85.567 267.939 87.46 267.939C89.353 267.939 91.179 268.389 91.519 268.939C91.859 269.489 93.235 269.939 94.578 269.939C96.081 269.939 97.019 270.515 97.019 271.439C97.019 272.263 97.501 272.938 98.09 272.938C99.475 272.938 102.019 275.482 102.019 276.866C102.019 277.455 102.469 277.937 103.019 277.937C103.569 277.937 104.019 279.076 104.019 280.468C104.019 281.86 104.694 283.258 105.519 283.574C107.675 284.402 107.675 297.467 105.519 298.294C104.694 298.61 104.019 300.008 104.019 301.401C104.019 302.792 103.569 303.931 103.019 303.931C102.469 303.931 102.019 304.413 102.019 305.002C102.019 306.387 99.475 308.93 98.09 308.93C97.501 308.93 97.019 309.605 97.019 310.43C97.019 311.263 96.13 311.929 95.019 311.929C93.908 311.929 93.019 311.263 93.019 310.43C93.019 309.605 93.469 308.93 94.019 308.93C94.59 308.93 95.019 305.931 95.019 301.932C95.019 298.033 94.576 294.867 94.019 294.783C90.769 294.296 90.519 294.592 90.519 298.932C90.519 302.836 90.222 303.473 88.269 303.751C86.19 304.046 86 299 85 295.5C85 295.5 84.5 295 83.5 294.933C82.5231 294.868 80.993 294.933 80.993 294.933C79.264 294.933 79.019 295.624 79.019 300.503C79.019 305.903 80.43 308.93 82.948 308.93C83.537 308.93 84.019 309.605 84.019 310.43C84.019 311.509 85.124 311.929 87.96 311.929C90.128 311.929 92.179 312.379 92.519 312.929C92.859 313.479 94.01 313.929 95.078 313.929C96.146 313.929 97.019 313.479 97.019 312.929C97.019 312.379 98.144 311.929 99.519 311.929C101.075 311.929 102.019 311.363 102.019 310.43C102.019 309.605 102.469 308.93 103.019 308.93C103.569 308.93 104.019 308.03 104.019 306.931C104.019 305.82 104.686 304.931 105.519 304.931C106.344 304.931 107.019 304.256 107.019 303.431C107.019 302.606 107.469 301.932 108.019 301.932C108.625 301.932 109.019 297.6 109.019 290.934C109.019 284.269 108.625 279.937 108.019 279.937C107.469 279.937 107.019 279.455 107.019 278.866C107.019 278.276 106.456 277.167 105.769 276.4C102.801 273.092 102.019 271.961 102.019 270.981C102.019 270.408 100.894 269.939 99.519 269.939C98.144 269.939 97.019 269.489 97.019 268.939C97.019 268.389 95.669 267.939 94.019 267.939C92.019 267.939 91.019 267.439 91.019 266.44C91.019 265.392 89.963 264.94 87.519 264.94C85.075 264.94 84.019 265.392 84.019 266.44C84.019 267.487 82.963 267.939 80.519 267.939C78.594 267.939 77.019 268.389 77.019 268.939C77.019 269.489 76.537 269.939 75.948 269.939C74.563 269.939 72.019 272.482 72.019 273.867C72.019 274.456 71.569 274.938 71.019 274.938C70.469 274.938 70.019 275.613 70.019 276.437C70.019 277.262 69.578 277.937 69.038 277.937C68.499 277.937 67.775 279.062 67.43 280.437C67.085 281.811 66.401 282.936 65.911 282.936C65.42 282.936 65.019 286.76 65.019 291.434C65.019 296.108 65.389 299.932 65.842 299.932C66.294 299.932 67.647 301.845 68.848 304.181C71.849 310.022 73.457 311.929 75.379 311.929C76.281 311.929 77.019 312.379 77.019 312.929C77.019 313.479 78.369 313.929 80.019 313.929C82.019 313.929 83.019 314.429 83.019 315.429C83.019 316.253 83.742 316.928 84.626 316.928C85.753 316.928 86.027 317.451 85.543 318.678C85.163 319.64 84.492 322.66 84.052 325.387C83.611 328.116 82.749 330.515 82.135 330.72C81.368 330.975 81.019 336.843 81.019 349.504C81.019 361.112 80.649 367.917 80.019 367.917C79.431 367.917 79.019 371.416 79.019 376.415C79.019 381.089 78.634 384.913 78.163 384.913C76.725 384.913 75.964 400.034 77.106 405.908C77.694 408.932 78.41 413.319 78.698 415.656C78.985 417.993 79.625 419.905 80.12 419.905C80.614 419.905 81.019 423.729 81.019 428.403C81.019 433.402 80.607 436.901 80.019 436.901C79.449 436.901 79.019 439.872 79.019 443.817C79.019 447.977 78.579 450.878 77.914 451.1C76.241 451.657 76.325 493.346 78.003 495.368C79.004 496.575 79.01 497.193 78.03 498.373C77.225 499.344 77.038 501.166 77.49 503.622C77.871 505.692 78.406 510.871 78.677 515.133L79.171 522.882H74.595C72.078 522.882 70.019 523.332 70.019 523.881C70.019 524.431 68.669 524.881 67.019 524.881C65.019 524.881 64.019 525.381 64.019 526.381C64.019 527.206 63.344 527.88 62.519 527.88C61.694 527.88 61.019 528.33 61.019 528.88C61.019 529.43 60.392 529.88 59.626 529.88C58.86 529.88 57.974 530.555 57.657 531.38C56.899 533.356 50.6391 533.356 48.6621 531.38C47.7661 530.484 45.321 529.88 42.59 529.88C40.076 529.88 38.019 529.43 38.019 528.88C38.019 528.33 37.119 527.88 36.019 527.88C34.919 527.88 34.019 527.468 34.019 526.963C34.019 525.196 35.241 522.882 36.174 522.882C36.691 522.882 38.157 521.757 39.431 520.382C40.706 519.008 42.4841 517.883 43.3841 517.883C44.2831 517.883 45.019 517.429 45.019 516.874C45.019 516.319 46.369 514.453 48.019 512.727C49.669 511 51.019 509.205 51.019 508.737C51.019 508.268 51.622 507.885 52.359 507.885C53.096 507.885 54.293 506.085 55.019 503.886C55.745 501.686 56.751 499.887 57.255 499.887C58.321 499.887 57.652 487.195 56.122 478.392C55.549 475.092 54.5721 468.344 53.9511 463.395C53.3301 458.446 52.4511 454.167 51.9981 453.886C50.8351 453.165 49.899 437.1 49.974 419.155C50.009 410.77 50.087 393.449 50.148 380.664C50.257 357.665 49.7531 349.303 48.0241 345.422C47.5331 344.322 46.893 341.623 46.6 339.423C46.307 337.224 45.531 331.375 44.875 326.426C44.219 321.477 43.3561 317.203 42.9571 316.928C41.8511 316.165 40.816 293.005 40.769 267.939C40.726 245.094 41.548 232.947 43.139 232.947C43.623 232.947 44.022 231.261 44.027 229.198C44.031 227.137 44.481 222.695 45.028 219.329C47.128 206.392 48.2361 194.809 49.0351 177.46C49.4901 167.562 50.188 155.733 50.587 151.173C51.299 143.015 49.945 134.969 47.859 134.969C47.397 134.969 46.9951 141.831 46.9661 150.216C46.9001 169.256 44.394 206.002 43.096 206.953C42.721 207.228 41.887 211.277 41.243 215.951C39.611 227.798 37.161 239.118 36.049 239.946C34.933 240.777 30.019 253.82 30.019 255.953C30.019 257.047 29.569 257.942 29.019 257.942C28.469 257.942 28.019 259.516 28.019 261.441C28.019 263.365 27.569 264.94 27.019 264.94C26.469 264.94 26.019 266.515 26.019 268.439C26.019 270.364 26.373 271.938 26.805 271.938C27.747 271.938 30.0211 294.689 30.0201 304.099C30.0191 311.548 29.4141 313.929 27.5201 313.929C26.8141 313.929 25.953 315.054 25.608 316.428C25.203 318.042 24.279 318.928 23 318.928C21.906 318.928 21.019 319.599 21.019 320.427C21.019 322.519 15.342 322.392 13.198 320.253C11.261 318.323 9.21304 308.043 9.09804 299.682C9.05504 296.52 8.56904 293.933 8.01904 293.933C7.46904 293.933 7.01905 295.91 7.01905 298.325C7.01905 302.283 5.96604 303.931 3.43704 303.931C3.20704 303.931 3.01905 301.457 3.01905 298.432C3.01905 295.408 3.46905 292.934 4.01905 292.934C4.58305 292.934 5.01905 290.101 5.01905 286.435C5.01905 282.769 5.45505 279.937 6.01905 279.937C6.56905 279.937 7.01905 279.262 7.01905 278.437C7.01905 277.612 7.39805 276.937 7.86205 276.937C8.32505 276.937 9.55205 275.363 10.5891 273.438C11.6261 271.514 12.821 269.939 13.246 269.939C13.671 269.939 14.019 267.941 14.019 265.499C14.019 263.056 14.469 260.781 15.019 260.441C15.569 260.101 16.019 258.073 16.019 255.932C16.019 253.793 16.446 249.882 16.967 247.243C17.489 244.605 18.104 237.608 18.335 231.698C18.671 223.069 18.484 220.95 17.387 220.95C16.495 220.95 16.019 222.147 16.019 224.39C16.019 226.283 15.662 228.051 15.225 228.321C14.788 228.591 14.3 234.575 14.142 241.619C13.976 248.975 13.417 254.696 12.827 255.06C12.263 255.409 11.587 257.888 11.325 260.567C10.874 265.168 7.40205 274.045 5.76905 274.771C5.35705 274.955 5.01905 275.742 5.01905 276.52C5.01905 277.3 4.34405 277.937 3.51905 277.937C2.59505 277.937 2.01905 278.875 2.01905 280.378C2.01905 281.72 1.56905 283.096 1.01905 283.436C-0.456955 284.348 -0.276958 306.235 1.21904 307.73C1.87904 308.39 3.45404 308.93 4.71904 308.93C6.49104 308.93 7.01905 309.491 7.01905 311.371C7.01905 312.713 7.46904 314.089 8.01904 314.429C8.56904 314.769 9.01904 317.044 9.01904 319.487C9.01904 323.895 9.04404 323.927 12.519 323.927C14.444 323.927 16.019 324.377 16.019 324.926C16.019 326.774 21.534 325.987 23.019 323.927C23.812 322.827 25.261 321.927 26.24 321.927C27.471 321.927 28.019 321.157 28.019 319.428C28.019 317.872 28.586 316.928 29.519 316.928C30.344 316.928 31.019 316.253 31.019 315.429C31.019 314.604 31.469 313.929 32.019 313.929C33.683 313.929 33.224 285.753 31.38 274.684L29.74 264.846L32.38 258.12C33.831 254.42 35.019 250.842 35.019 250.168C35.019 249.495 35.469 248.944 36.019 248.944C36.569 248.944 37.019 250.968 37.019 253.443C37.019 255.917 36.569 257.942 36.019 257.942C35.419 257.942 35.019 261.941 35.019 267.939C35.019 273.938 35.419 277.937 36.019 277.937C36.61 277.937 37.0151 281.513 37.0091 286.685C37.0041 291.497 37.4741 299.932 38.0541 305.431C40.6171 329.731 42.424 342.922 43.191 342.922C43.647 342.922 44.019 344.407 44.019 346.222C44.019 348.036 44.485 349.987 45.055 350.557C46.744 352.245 48.477 393.006 47.142 399.652C44.765 411.486 46.326 446.692 50.049 465.221C50.583 467.875 51.019 471.324 51.019 472.886C51.019 474.448 51.5071 475.888 52.1041 476.087C52.7961 476.318 53.2491 481.025 53.3541 489.077C53.5101 501.031 53.399 501.809 51.269 503.663C50.031 504.739 49.019 506.03 49.019 506.532C49.019 507.033 48.119 508.092 47.019 508.885C45.919 509.678 45.019 510.901 45.019 511.605C45.019 512.308 44.344 512.884 43.519 512.884C42.694 512.884 42.019 513.334 42.019 513.884C42.019 514.434 41.344 514.883 40.519 514.883C39.694 514.883 39.019 515.365 39.019 515.954C39.019 517.548 36.386 519.882 34.59 519.882C33.726 519.882 33.019 520.557 33.019 521.382C33.019 522.207 32.599 522.882 32.086 522.882C30.784 522.882 29.846 526.268 30.603 528.239C30.95 529.142 31.892 529.88 32.697 529.88C33.503 529.88 34.8371 530.555 35.6621 531.38C36.4871 532.205 38.678 532.879 40.531 532.879C42.385 532.879 44.179 533.329 44.519 533.879C44.859 534.429 48.4851 534.879 52.5781 534.879C56.8721 534.879 60.019 534.456 60.019 533.879C60.019 533.329 60.694 532.879 61.519 532.879C62.344 532.879 63.019 532.205 63.019 531.38C63.019 530.547 63.908 529.88 65.019 529.88C66.119 529.88 67.019 529.43 67.019 528.88C67.019 528.33 67.708 527.88 68.55 527.88C69.393 527.88 70.341 527.206 70.657 526.381C71.061 525.33 72.699 524.881 76.126 524.881C78.817 524.881 81.019 524.431 81.019 523.881C81.019 523.332 81.694 522.882 82.519 522.882C84.603 522.882 84.603 513.611 82.519 511.527C81.345 510.353 81.019 507.298 81.019 497.458C81.019 489.746 80.633 484.89 80.019 484.89C79.408 484.89 79.019 480.224 79.019 472.893C79.019 465.562 79.408 460.896 80.019 460.896C80.601 460.896 81.019 457.598 81.019 453.004C81.019 446.912 81.361 444.982 82.519 444.537C83.757 444.062 84.019 441.426 84.019 429.434C84.019 417.187 83.784 414.906 82.519 414.906C81.386 414.906 81.019 413.684 81.019 409.907C81.019 407.158 80.569 404.908 80.019 404.908C79.441 404.908 79.019 401.742 79.019 397.41C79.019 393.078 79.441 389.912 80.019 389.912C80.573 389.912 81.019 387.273 81.019 383.996C81.019 380.152 81.457 377.935 82.269 377.666C83.202 377.356 83.597 372.006 83.826 356.587C84.005 344.531 84.526 335.924 85.076 335.924C85.595 335.924 86.019 333.674 86.019 330.925C86.019 328.176 86.469 325.926 87.019 325.926C87.636 325.926 88.019 331.064 88.019 339.34C88.019 346.718 88.429 352.903 88.93 353.087C89.936 353.455 92.223 382.799 92.229 395.41C92.233 405.678 90.747 416.163 89.215 416.674C87.597 417.213 87.521 441.567 89.134 442.105C91.367 442.849 94.26 490.889 92.072 490.889C91.38 490.889 91.019 496.225 91.019 506.456C91.019 522.503 91.577 524.881 95.341 524.881C96.146 524.881 97.064 525.556 97.381 526.381C97.697 527.206 98.87 527.88 99.988 527.88C101.105 527.88 102.019 528.33 102.019 528.88C102.019 529.43 103.144 529.88 104.519 529.88C105.894 529.88 107.019 530.362 107.019 530.951C107.019 532.544 109.652 534.879 111.448 534.879C112.312 534.879 113.019 535.329 113.019 535.879C113.019 536.429 114.594 536.878 116.519 536.878C118.444 536.878 120.019 536.429 120.019 535.879C120.019 535.329 122.269 534.879 125.019 534.879C127.769 534.879 130.019 534.429 130.019 533.879C130.019 533.329 131.369 532.879 133.019 532.879C135.019 532.879 136.019 532.379 136.019 531.38C136.019 530.555 136.694 529.88 137.519 529.88C138.452 529.88 139.019 528.936 139.019 527.381C139.019 525.825 138.452 524.881 137.519 524.881C136.694 524.881 136.019 524.431 136.019 523.881C136.019 523.332 135.374 522.882 134.586 522.882C133.798 522.882 132.841 521.898 132.46 520.695C132.078 519.493 130.248 517.078 128.392 515.328C126.537 513.58 125.019 511.638 125.019 511.016C125.019 510.393 124.569 509.885 124.019 509.885C123.469 509.885 123.019 509.033 123.019 507.992C123.019 506.951 122.344 505.84 121.519 505.524C120.694 505.208 120.019 503.81 120.019 502.417C120.019 501.026 119.529 499.887 118.931 499.887C116.675 499.887 119.599 450.393 121.941 448.946C122.465 448.622 123.133 442.968 123.425 436.381C123.717 429.794 124.398 418.105 124.938 410.407C125.479 402.709 126.318 389.012 126.803 379.97C127.389 369.026 128.075 363.399 128.852 363.14C129.56 362.904 130.019 360.503 130.019 357.036C130.019 353.892 130.429 350.893 130.931 350.371C131.433 349.848 132.061 346.946 132.327 343.922C132.593 340.898 133.517 332.779 134.379 325.879C135.298 318.529 136.142 301.763 136.418 285.388C136.677 270.018 136.918 256.88 136.954 256.192C136.99 255.505 137.469 254.942 138.019 254.942C138.646 254.942 139.019 261.208 139.019 271.738C139.019 281.575 139.432 288.948 140.017 289.532C140.565 290.08 141.277 296.132 141.598 302.979C142.319 318.339 144.146 323.927 148.448 323.927C149.312 323.927 150.019 324.377 150.019 324.926C150.019 325.476 150.919 325.926 152.019 325.926C153.13 325.926 154.019 326.593 154.019 327.426C154.019 329.716 155.526 329.214 157.019 326.426C157.841 324.89 159.23 323.927 160.621 323.927C163.65 323.927 164.142 321.924 163.857 310.75C163.548 298.642 164.171 297.681 168.962 302.87C174.433 308.794 176.019 308.358 176.019 300.932C176.019 297.6 175.575 294.933 175.019 294.933C174.469 294.933 174.019 293.611 174.019 291.993C174.019 290.375 173.569 288.775 173.019 288.435C172.469 288.095 172.019 286.734 172.019 285.41C172.019 282.409 169.105 275.971 166.773 273.821C165.808 272.931 165.019 271.858 165.019 271.436C165.019 271.014 163.997 269.717 162.747 268.554C159.257 265.306 158.019 259.376 158.019 245.91C158.019 231.034 156.505 220.95 154.272 220.95C152.964 220.95 152.838 221.976 153.444 227.698C153.837 231.411 154.562 240.97 155.056 248.944C156.165 266.871 156.479 268.211 160.552 272.405C162.358 274.264 164.132 276.719 164.495 277.861C164.857 279.003 165.573 279.937 166.086 279.937C166.599 279.937 167.019 280.836 167.019 281.936C167.019 283.036 167.357 283.936 167.769 283.936C168.182 283.936 169.352 286.748 170.37 290.184C171.387 293.622 172.625 297.214 173.12 298.168C174.39 300.621 174.237 301.932 172.68 301.932C171.943 301.932 170.827 300.807 170.201 299.432C169.574 298.058 168.602 296.933 168.04 296.933C167.479 296.933 167.019 296.038 167.019 294.944C167.019 292.637 164.049 288.799 162.841 289.544C162.389 289.824 162.019 291.6 162.019 293.493C162.019 295.385 161.569 296.933 161.019 296.933C160.406 296.933 160.019 301.765 160.019 309.43C160.019 319.872 159.772 321.927 158.519 321.927C157.694 321.927 157.019 322.377 157.019 322.927C157.019 323.477 156.119 323.927 155.019 323.927C153.919 323.927 153.019 323.477 153.019 322.927C153.019 322.377 152.33 321.927 151.488 321.927C150.645 321.927 149.697 321.252 149.381 320.427C149.064 319.603 148.178 318.928 147.412 318.928C146.31 318.928 146.019 316.736 146.019 308.43C146.019 302.656 145.637 297.933 145.171 297.933C143.666 297.933 141.882 281.093 142.608 273.733C143.292 266.792 141.845 254.32 139.936 250.707C139.432 249.752 139.019 247.615 139.019 245.958C139.019 244.301 138.682 242.944 138.269 242.943C137.856 242.942 136.689 239.23 135.675 234.695C134.66 230.16 133.454 225.324 132.993 223.949C132.251 221.733 131.571 212.584 130.729 193.456C130.584 190.157 130.365 174.523 130.242 158.714C130.069 136.389 129.738 129.971 128.76 129.971C128.067 129.971 126.937 130.871 126.249 131.973ZM135.271 249.444C135.282 251.643 135.487 252.425 135.726 251.181C135.965 249.937 135.956 248.138 135.706 247.182C135.456 246.226 135.26 247.244 135.271 249.444ZM87.574 306.931C84.182 306.931 84.124 306.859 83.824 302.26C83.389 295.589 81.019 295.242 81.019 301.849C81.019 305.7 81.382 306.931 82.519 306.931C83.344 306.931 84.019 307.38 84.019 307.93C84.019 309.524 90.006 309.086 91.726 307.366C92.894 306.199 93.002 305.514 92.155 304.667C91.307 303.819 91.019 303.962 91.019 305.231C91.019 306.502 90.15 306.931 87.574 306.931Z"
          fill="black"
        />
        <path
          fill-rule="evenodd"
          clip-rule="evenodd"
          d="M76.519 2.99932C78.075 2.99932 79.019 2.43245 79.019 1.49966C79.019 0.291934 80.575 0 87.019 0C91.419 0 95.019 0.419905 95.019 0.932789C95.019 1.44567 95.988 2.17251 97.172 2.54842C99.539 3.29925 107.019 10.5076 107.019 12.0373C107.019 12.5652 107.469 12.9971 108.019 12.9971C108.569 12.9971 109.019 13.8969 109.019 14.9966C109.019 16.0964 109.469 16.9962 110.019 16.9962C110.569 16.9962 111.019 18.5708 111.019 20.4954C111.019 22.4199 111.469 23.9946 112.019 23.9946C112.611 23.9946 113.019 27.6407 113.019 32.9335C113.019 37.8504 112.569 42.1505 112.019 42.4904C111.469 42.8303 111.019 44.6559 111.019 46.5485C111.019 48.441 110.569 49.9887 110.019 49.9887C109.469 49.9887 109.019 52.0132 109.019 54.4877C109.019 56.9621 108.569 58.9866 108.019 58.9866C107.469 58.9866 107.019 60.1114 107.019 61.4861C107.019 62.8608 106.569 63.9855 106.019 63.9855C105.469 63.9855 105.019 65.1103 105.019 66.4849C105.019 67.8596 105.469 68.9844 106.019 68.9844C106.569 68.9844 107.019 69.9372 107.019 71.1019C107.019 73.2994 112.576 78.9381 114.769 78.9661C115.457 78.9751 116.019 79.33 116.019 79.755C116.019 80.1799 117.594 81.3746 119.519 82.4113C121.444 83.4481 123.019 84.6748 123.019 85.1377C123.019 85.6016 123.658 85.9805 124.438 85.9805C126.222 85.9805 132.004 89.2238 132.013 90.2296C132.016 90.6415 132.582 90.9884 133.269 90.9984C133.957 91.0094 136.314 92.584 138.508 94.4976C140.702 96.4122 142.84 97.9778 143.258 97.9778C143.677 97.9778 144.019 98.6527 144.019 99.4775C144.019 100.302 144.401 100.977 144.867 100.977C145.334 100.977 146.492 102.889 147.44 105.226C148.737 108.42 149.383 114.441 150.041 129.471C151.066 152.872 151.286 190.098 150.412 192.374C148.707 196.816 148.071 191.87 147.563 170.211C146.238 113.74 145.996 108.809 144.475 107.29C143.674 106.489 143.019 105.29 143.019 104.625C143.019 103.961 142.119 102.77 141.019 101.977C139.919 101.184 139.019 99.9604 139.019 99.2565C139.019 98.5537 138.457 97.9768 137.769 97.9768C137.082 97.9758 135.169 96.7991 133.519 95.3604C131.869 93.9227 129.281 92.3051 127.769 91.7652C126.257 91.2254 125.019 90.4395 125.019 90.0176C125.019 89.5967 122.994 88.478 120.519 87.5332C118.044 86.5884 116.019 85.4027 116.019 84.8978C116.019 84.3939 115.55 83.981 114.977 83.981C113.887 83.981 112.528 82.9822 108.516 79.2321C107.193 77.9953 105.639 76.9826 105.064 76.9826C104.489 76.9826 104.019 75.8578 104.019 74.4831C104.019 73.1085 103.569 71.9837 103.019 71.9837C102.469 71.9837 102.019 69.7342 102.019 66.9848C102.019 64.2355 102.469 61.986 103.019 61.986C103.569 61.986 104.019 60.2184 104.019 58.0579C104.019 55.8983 104.694 53.4559 105.519 52.6311C106.344 51.8063 107.019 50.1996 107.019 49.0599C107.019 47.9212 107.469 46.9894 108.019 46.9894C108.632 46.9894 109.019 42.1575 109.019 34.4922C109.019 26.8269 108.632 21.995 108.019 21.995C107.469 21.995 107.019 20.8703 107.019 19.4956C107.019 18.1209 106.599 16.9962 106.086 16.9962C105.573 16.9962 104.845 16.0224 104.467 14.8316C103.675 12.3382 99.609 7.99819 98.064 7.99819C97.489 7.99819 97.019 7.32334 97.019 6.49853C97.019 5.26581 95.241 4.99887 87.019 4.99887C78.797 4.99887 77.019 5.26581 77.019 6.49853C77.019 7.32334 76.232 8.01219 75.269 8.03018C73.42 8.06317 70.019 10.2467 70.019 11.3994C70.019 11.7753 69.457 12.7531 68.769 13.5739C68.082 14.3947 67.064 15.6125 66.507 16.2813C63.96 19.3406 63.019 23.7256 63.019 32.5396C63.019 38.1734 63.423 41.9905 64.019 41.9905C64.569 41.9905 65.019 43.5651 65.019 45.4897C65.019 47.7242 65.497 48.9889 66.341 48.9889C67.162 48.9889 68.176 51.4514 69.019 55.4874C69.765 59.0616 70.745 61.986 71.197 61.986C71.649 61.986 72.019 63.5226 72.019 65.4022C72.019 67.2808 72.582 69.0214 73.269 69.2703C74.269 69.6322 74.269 70.1461 73.269 71.8397C72.582 73.0035 72.019 74.6431 72.019 75.4829C72.019 78.9671 67.865 83.891 64.876 83.949C63.972 83.967 62.974 84.6558 62.657 85.4807C62.341 86.3055 61.1681 86.9803 60.0501 86.9803C58.9331 86.9803 58.019 87.4302 58.019 87.9801C58.019 88.53 56.894 88.9799 55.519 88.9799C54.144 88.9799 53.019 89.4298 53.019 89.9796C53.019 90.5295 52.359 90.9794 51.553 90.9794C49.497 90.9794 42.8991 94.1357 40.5801 96.2282C39.5141 97.19 38.2771 97.9778 37.8301 97.9778C37.3841 97.9778 37.019 98.6527 37.019 99.4775C37.019 100.302 36.379 100.977 35.597 100.977C33.911 100.977 28.019 112.308 28.019 115.55C28.019 116.792 27.498 117.98 26.861 118.192C25.274 118.721 24.0431 149.642 25.1191 161.963C26.1161 173.386 26.223 185.091 25.377 190.207C24.91 193.035 24.282 193.956 22.821 193.956C21.237 193.956 21.033 193.546 21.702 191.707C22.151 190.469 22.399 184.62 22.253 178.71C21.485 147.717 21.647 128.818 22.74 121.972C24.698 109.704 25.1781 107.976 26.6321 107.976C27.4091 107.976 28.019 106.973 28.019 105.697C28.019 104.443 28.919 102.77 30.019 101.977C31.119 101.184 32.019 100.153 32.019 99.6854C32.019 98.6727 34.5881 95.9783 35.5541 95.9783C35.9261 95.9783 37.116 94.8535 38.198 93.4788C39.279 92.1041 40.994 90.9794 42.008 90.9794C43.022 90.9794 44.0021 90.6415 44.1861 90.2296C44.6421 89.2018 51.745 85.9805 53.553 85.9805C54.359 85.9805 55.019 85.5306 55.019 84.9808C55.019 84.4309 55.513 83.981 56.118 83.981C57.786 83.981 64.309 80.7467 66.133 79.0151C70.349 75.013 71.109 69.4093 68.269 63.2697C67.306 61.1891 66.249 59.2616 65.918 58.9866C65.587 58.7117 65.041 57.362 64.703 55.9873C62.11 45.4427 59.645 37.4385 58.902 37.1586C57.832 36.7547 57.708 24.2995 58.769 23.8276C59.181 23.6446 60.3461 21.0722 61.3581 18.1119C63.1381 12.9011 66.83 7.99819 68.974 7.99819C69.549 7.99819 70.019 7.32334 70.019 6.49853C70.019 5.66572 70.908 4.99887 72.019 4.99887C73.119 4.99887 74.019 4.54897 74.019 3.99909C74.019 3.44922 75.144 2.99932 76.519 2.99932ZM93.126 68.9844C94.167 68.9844 95.019 68.5345 95.019 67.9846C95.019 67.4347 96.144 66.9848 97.519 66.9848C98.894 66.9848 100.019 67.4347 100.019 67.9846C100.019 68.5345 98.894 68.9844 97.519 68.9844C96.144 68.9844 95.015 69.5473 95.011 70.2341C95.007 70.9219 93.792 72.0467 92.312 72.7335C89.101 74.2242 81.019 74.4032 81.019 72.9835C81.019 72.4336 80.119 71.9837 79.019 71.9837C77.908 71.9837 77.019 71.3169 77.019 70.484C77.019 68.7884 80.661 68.4095 81.207 70.0491C81.402 70.634 83.457 71.3668 85.772 71.6778C89.09 72.1227 90.115 71.8967 90.608 70.613C90.952 69.7172 92.085 68.9844 93.126 68.9844ZM102.269 86.8004C99.841 87.1443 99.018 84.5479 101.269 83.6481C103.16 82.8912 104.519 83.4831 104.519 85.0637C104.519 85.8426 103.507 86.6244 102.269 86.8004ZM76.066 87.9801C74.398 87.9801 70.019 85.6916 70.019 84.8198C70.019 84.3589 71.594 83.981 73.519 83.981C76.352 83.981 77.019 84.3619 77.019 85.9805C77.019 87.0803 76.59 87.9801 76.066 87.9801ZM80.517 88.341C79.188 87.8311 79.121 87.5312 80.185 86.8563C80.919 86.3914 81.82 86.0045 82.187 85.9955C83.663 85.9615 86.019 87.2482 86.019 88.0871C86.019 89.1248 82.931 89.2668 80.517 88.341ZM94.019 88.9799C92.019 88.9799 91.019 88.48 91.019 87.4802C91.019 86.4804 92.019 85.9805 94.019 85.9805C96.019 85.9805 97.019 86.4804 97.019 87.4802C97.019 88.48 96.019 88.9799 94.019 88.9799ZM131.412 105.976C129.694 105.976 129.666 105.134 131.269 101.684C132.731 98.5367 134.019 98.1678 134.019 100.895C134.019 103.875 132.941 105.976 131.412 105.976ZM40.18 105.429C39.541 104.028 39.019 102.454 39.019 101.93C39.019 101.406 39.694 100.977 40.519 100.977C41.344 100.977 42.019 101.652 42.019 102.477C42.019 103.302 42.469 103.976 43.019 103.976C43.569 103.976 44.019 104.876 44.019 105.976C44.019 108.808 41.56 108.457 40.18 105.429ZM128.654 115.686C127.298 115.235 126.632 112.427 127.403 110.417C128.578 107.355 130.627 108.892 130.204 112.52C129.963 114.58 129.314 115.906 128.654 115.686ZM46.538 117.973C44.795 117.973 43.507 113.739 44.486 111.227C45.043 109.797 45.431 110.094 46.594 112.839C48.393 117.086 48.383 117.973 46.538 117.973ZM127.389 125.722C126.418 129.343 125.019 128.31 125.019 123.972C125.019 121.084 125.436 119.973 126.519 119.973C128.096 119.973 128.397 121.96 127.389 125.722ZM49.626 129.971C48.097 129.971 47.019 127.87 47.019 124.89C47.019 121.913 48.703 122.628 49.921 126.12C50.7824 128.591 51.1057 129.477 50.8129 129.794C50.6393 129.982 50.2491 129.971 49.626 129.971ZM56.019 198.955C52.686 198.955 50.019 198.511 50.019 197.955C50.019 197.399 52.686 196.955 56.019 196.955C59.352 196.955 62.019 197.399 62.019 197.955C62.019 198.511 59.352 198.955 56.019 198.955ZM71.019 198.955C67.686 198.955 65.019 198.511 65.019 197.955C65.019 197.399 67.686 196.955 71.019 196.955C74.352 196.955 77.019 197.399 77.019 197.955C77.019 198.511 74.352 198.955 71.019 198.955ZM84.46 198.955C81.467 198.955 79.019 198.505 79.019 197.955C79.019 197.398 81.705 196.955 85.078 196.955C88.863 196.955 90.905 197.33 90.519 197.955C90.179 198.505 87.453 198.955 84.46 198.955ZM96.519 198.955C94.594 198.955 93.019 198.505 93.019 197.955C93.019 197.405 94.594 196.955 96.519 196.955C98.444 196.955 100.019 197.405 100.019 197.955C100.019 198.505 98.444 198.955 96.519 198.955ZM107.519 198.955C105.594 198.955 104.019 198.505 104.019 197.955C104.019 197.405 105.594 196.955 107.519 196.955C109.444 196.955 111.019 197.405 111.019 197.955C111.019 198.505 109.444 198.955 107.519 198.955ZM118.019 200.108C118.019 199.642 117.007 198.772 115.769 198.175C113.861 197.255 114.393 197.08 119.269 197.023C125.36 196.951 125.87 197.247 123.59 199.526C122.046 201.07 118.019 201.49 118.019 200.108ZM46.519 249.943C44.686 249.943 44.019 249.411 44.019 247.944C44.019 246.844 44.469 245.944 45.019 245.944C45.569 245.944 46.019 246.363 46.019 246.874C46.019 247.386 47.031 247.949 48.269 248.124C50.553 248.449 52.2501 252.943 50.0891 252.943C49.5001 252.943 49.019 252.268 49.019 251.443C49.019 250.51 48.075 249.943 46.519 249.943ZM135.271 249.444C135.282 251.643 135.487 252.425 135.726 251.181C135.965 249.937 135.956 248.138 135.706 247.182C135.456 246.226 135.26 247.244 135.271 249.444ZM122.519 249.943C123.894 249.943 125.019 249.494 125.019 248.944C125.019 248.394 126.144 247.944 127.519 247.944C128.894 247.944 130.019 248.394 130.019 248.944C130.019 249.494 129.344 249.943 128.519 249.943C127.694 249.943 127.019 250.618 127.019 251.443C127.019 252.268 126.156 252.943 125.102 252.943C124.048 252.943 122.957 253.506 122.678 254.192C122.297 255.133 121.909 255.071 121.11 253.943C119.348 251.451 119.879 249.943 122.519 249.943ZM59.519 257.942C58.13 257.942 54.019 254.578 54.019 253.443C54.019 253.168 54.919 252.943 56.019 252.943C57.119 252.943 58.019 253.362 58.019 253.873C58.019 254.384 59.031 254.947 60.269 255.122C62.553 255.447 64.2501 259.941 62.0891 259.941C61.5001 259.941 61.019 259.491 61.019 258.941C61.019 258.392 60.344 257.942 59.519 257.942ZM114.519 254.942C115.344 254.942 116.019 254.492 116.019 253.943C116.019 253.393 116.469 252.943 117.019 252.943C118.523 252.943 118.22 256.884 116.59 258.512C114.961 260.142 111.019 260.445 111.019 258.941C111.019 258.392 111.469 257.942 112.019 257.942C112.569 257.942 113.019 257.267 113.019 256.442C113.019 255.617 113.694 254.942 114.519 254.942ZM66.519 264.94C65.586 264.94 65.019 263.996 65.019 262.441C65.019 260.885 65.586 259.941 66.519 259.941C67.344 259.941 68.019 260.517 68.019 261.22C68.019 261.924 68.919 263.147 70.019 263.94C71.964 265.342 72.652 267.973 71.4 269.225C70.641 269.983 68.019 267.491 68.019 266.011C68.019 265.422 67.344 264.94 66.519 264.94ZM104.519 267.939C101.786 267.939 101.324 266.645 103.269 264.436C104.7 262.81 109.019 262.439 109.019 263.94C109.019 264.49 108.569 264.94 108.019 264.94C107.469 264.94 107.019 265.615 107.019 266.44C107.019 267.372 106.075 267.939 104.519 267.939Z"
          fill="black"
        />
        <path
          d="M78.8427 43V39.42H72.8527V37.33L78.3427 29H80.9227V37.34H82.2027V39.42H80.9227V43H78.8427ZM75.2727 37.33L78.8427 37.34L78.8227 31.87L75.2727 37.33ZM85.2904 43.26C84.9837 43.26 84.7237 43.1533 84.5104 42.94C84.3037 42.7267 84.2004 42.4667 84.2004 42.16C84.2004 41.86 84.3037 41.6033 84.5104 41.39C84.7237 41.1767 84.9837 41.07 85.2904 41.07C85.5971 41.07 85.8571 41.1767 86.0704 41.39C86.2837 41.6033 86.3904 41.86 86.3904 42.16C86.3904 42.4667 86.2837 42.7267 86.0704 42.94C85.8571 43.1533 85.5971 43.26 85.2904 43.26ZM93.0296 43.26C92.1429 43.26 91.3396 43.0467 90.6196 42.62C89.9063 42.1867 89.3396 41.6133 88.9196 40.9C88.5063 40.18 88.2996 39.3933 88.2996 38.54H90.3796C90.3796 39.0267 90.4996 39.47 90.7396 39.87C90.9796 40.27 91.2996 40.59 91.6996 40.83C92.0996 41.0633 92.5429 41.18 93.0296 41.18C93.5096 41.18 93.9496 41.0633 94.3496 40.83C94.7496 40.59 95.0696 40.27 95.3096 39.87C95.5496 39.47 95.6696 39.0267 95.6696 38.54C95.6696 38.0533 95.5596 37.61 95.3396 37.21C95.1196 36.8033 94.7896 36.48 94.3496 36.24C93.9096 35.9933 93.3496 35.87 92.6696 35.87H89.1396L90.5596 29H97.3296V31.08H92.2496L91.6996 33.79L92.9096 33.81C93.8629 33.83 94.6996 34.05 95.4196 34.47C96.1463 34.8833 96.7163 35.4433 97.1296 36.15C97.5429 36.85 97.7496 37.6467 97.7496 38.54C97.7496 39.1867 97.6263 39.7967 97.3796 40.37C97.1329 40.9367 96.7929 41.4367 96.3596 41.87C95.9329 42.3033 95.4329 42.6433 94.8596 42.89C94.2929 43.1367 93.6829 43.26 93.0296 43.26Z"
          fill="black"
        />
        <path
          d="M144.843 213V209.42H138.853V207.33L144.343 199H146.923V207.34H148.203V209.42H146.923V213H144.843ZM141.273 207.33L144.843 207.34L144.823 201.87L141.273 207.33ZM151.29 213.26C150.984 213.26 150.724 213.153 150.51 212.94C150.304 212.727 150.2 212.467 150.2 212.16C150.2 211.86 150.304 211.603 150.51 211.39C150.724 211.177 150.984 211.07 151.29 211.07C151.597 211.07 151.857 211.177 152.07 211.39C152.284 211.603 152.39 211.86 152.39 212.16C152.39 212.467 152.284 212.727 152.07 212.94C151.857 213.153 151.597 213.26 151.29 213.26ZM159.03 213.26C158.143 213.26 157.34 213.047 156.62 212.62C155.906 212.187 155.34 211.613 154.92 210.9C154.506 210.18 154.3 209.393 154.3 208.54H156.38C156.38 209.027 156.5 209.47 156.74 209.87C156.98 210.27 157.3 210.59 157.7 210.83C158.1 211.063 158.543 211.18 159.03 211.18C159.51 211.18 159.95 211.063 160.35 210.83C160.75 210.59 161.07 210.27 161.31 209.87C161.55 209.47 161.67 209.027 161.67 208.54C161.67 208.053 161.56 207.61 161.34 207.21C161.12 206.803 160.79 206.48 160.35 206.24C159.91 205.993 159.35 205.87 158.67 205.87H155.14L156.56 199H163.33V201.08H158.25L157.7 203.79L158.91 203.81C159.863 203.83 160.7 204.05 161.42 204.47C162.146 204.883 162.716 205.443 163.13 206.15C163.543 206.85 163.75 207.647 163.75 208.54C163.75 209.187 163.626 209.797 163.38 210.37C163.133 210.937 162.793 211.437 162.36 211.87C161.933 212.303 161.433 212.643 160.86 212.89C160.293 213.137 159.683 213.26 159.03 213.26Z"
          fill="black"
        />
        <path
          d="M11.8427 213V209.42H5.85273V207.33L11.3427 199H13.9227V207.34H15.2027V209.42H13.9227V213H11.8427ZM8.27273 207.33L11.8427 207.34L11.8227 201.87L8.27273 207.33ZM18.2904 213.26C17.9837 213.26 17.7237 213.153 17.5104 212.94C17.3037 212.727 17.2004 212.467 17.2004 212.16C17.2004 211.86 17.3037 211.603 17.5104 211.39C17.7237 211.177 17.9837 211.07 18.2904 211.07C18.5971 211.07 18.8571 211.177 19.0704 211.39C19.2837 211.603 19.3904 211.86 19.3904 212.16C19.3904 212.467 19.2837 212.727 19.0704 212.94C18.8571 213.153 18.5971 213.26 18.2904 213.26ZM26.0296 213.26C25.1429 213.26 24.3396 213.047 23.6196 212.62C22.9063 212.187 22.3396 211.613 21.9196 210.9C21.5063 210.18 21.2996 209.393 21.2996 208.54H23.3796C23.3796 209.027 23.4996 209.47 23.7396 209.87C23.9796 210.27 24.2996 210.59 24.6996 210.83C25.0996 211.063 25.5429 211.18 26.0296 211.18C26.5096 211.18 26.9496 211.063 27.3496 210.83C27.7496 210.59 28.0696 210.27 28.3096 209.87C28.5496 209.47 28.6696 209.027 28.6696 208.54C28.6696 208.053 28.5596 207.61 28.3396 207.21C28.1196 206.803 27.7896 206.48 27.3496 206.24C26.9096 205.993 26.3496 205.87 25.6696 205.87H22.1396L23.5596 199H30.3296V201.08H25.2496L24.6996 203.79L25.9096 203.81C26.8629 203.83 27.6996 204.05 28.4196 204.47C29.1463 204.883 29.7163 205.443 30.1296 206.15C30.5429 206.85 30.7496 207.647 30.7496 208.54C30.7496 209.187 30.6263 209.797 30.3796 210.37C30.1329 210.937 29.7929 211.437 29.3596 211.87C28.9329 212.303 28.4329 212.643 27.8596 212.89C27.2929 213.137 26.6829 213.26 26.0296 213.26Z"
          fill="black"
        />
        <path
          d="M85.2096 154L88.0396 149.1C87.3663 149.227 86.7096 149.2 86.0696 149.02C85.4363 148.833 84.8663 148.53 84.3596 148.11C83.8529 147.683 83.4496 147.167 83.1496 146.56C82.8496 145.953 82.6996 145.287 82.6996 144.56C82.6996 143.9 82.8229 143.28 83.0696 142.7C83.3229 142.113 83.6696 141.6 84.1096 141.16C84.5496 140.713 85.0596 140.367 85.6396 140.12C86.2263 139.867 86.8529 139.74 87.5196 139.74C88.3929 139.74 89.1929 139.957 89.9196 140.39C90.6463 140.823 91.2263 141.407 91.6596 142.14C92.0929 142.867 92.3096 143.673 92.3096 144.56C92.3096 145.02 92.2529 145.44 92.1396 145.82C92.0329 146.2 91.8629 146.6 91.6296 147.02L87.6196 154H85.2096ZM87.4996 147.29C88.0329 147.29 88.5063 147.163 88.9196 146.91C89.3329 146.65 89.6563 146.313 89.8896 145.9C90.1296 145.48 90.2496 145.03 90.2496 144.55C90.2496 144.03 90.1229 143.563 89.8696 143.15C89.6163 142.737 89.2796 142.41 88.8596 142.17C88.4463 141.93 87.9996 141.81 87.5196 141.81C86.9863 141.81 86.5129 141.94 86.0996 142.2C85.6863 142.46 85.3596 142.8 85.1196 143.22C84.8796 143.633 84.7596 144.077 84.7596 144.55C84.7596 145.05 84.8796 145.51 85.1196 145.93C85.3663 146.343 85.6963 146.673 86.1096 146.92C86.5229 147.167 86.9863 147.29 87.4996 147.29Z"
          fill="black"
        />
        <path
          d="M83.2096 237L86.0396 232.1C85.3663 232.227 84.7096 232.2 84.0696 232.02C83.4363 231.833 82.8663 231.53 82.3596 231.11C81.8529 230.683 81.4496 230.167 81.1496 229.56C80.8496 228.953 80.6996 228.287 80.6996 227.56C80.6996 226.9 80.8229 226.28 81.0696 225.7C81.3229 225.113 81.6696 224.6 82.1096 224.16C82.5496 223.713 83.0596 223.367 83.6396 223.12C84.2263 222.867 84.8529 222.74 85.5196 222.74C86.3929 222.74 87.1929 222.957 87.9196 223.39C88.6463 223.823 89.2263 224.407 89.6596 225.14C90.0929 225.867 90.3096 226.673 90.3096 227.56C90.3096 228.02 90.2529 228.44 90.1396 228.82C90.0329 229.2 89.8629 229.6 89.6296 230.02L85.6196 237H83.2096ZM85.4996 230.29C86.0329 230.29 86.5063 230.163 86.9196 229.91C87.3329 229.65 87.6563 229.313 87.8896 228.9C88.1296 228.48 88.2496 228.03 88.2496 227.55C88.2496 227.03 88.1229 226.563 87.8696 226.15C87.6163 225.737 87.2796 225.41 86.8596 225.17C86.4463 224.93 85.9996 224.81 85.5196 224.81C84.9863 224.81 84.5129 224.94 84.0996 225.2C83.6863 225.46 83.3596 225.8 83.1196 226.22C82.8796 226.633 82.7596 227.077 82.7596 227.55C82.7596 228.05 82.8796 228.51 83.1196 228.93C83.3663 229.343 83.6963 229.673 84.1096 229.92C84.5229 230.167 84.9863 230.29 85.4996 230.29Z"
          fill="black"
        />
        <path
          d="M106.21 411L109.04 406.1C108.366 406.227 107.71 406.2 107.07 406.02C106.436 405.833 105.866 405.53 105.36 405.11C104.853 404.683 104.45 404.167 104.15 403.56C103.85 402.953 103.7 402.287 103.7 401.56C103.7 400.9 103.823 400.28 104.07 399.7C104.323 399.113 104.67 398.6 105.11 398.16C105.55 397.713 106.06 397.367 106.64 397.12C107.226 396.867 107.853 396.74 108.52 396.74C109.393 396.74 110.193 396.957 110.92 397.39C111.646 397.823 112.226 398.407 112.66 399.14C113.093 399.867 113.31 400.673 113.31 401.56C113.31 402.02 113.253 402.44 113.14 402.82C113.033 403.2 112.863 403.6 112.63 404.02L108.62 411H106.21ZM108.5 404.29C109.033 404.29 109.506 404.163 109.92 403.91C110.333 403.65 110.656 403.313 110.89 402.9C111.13 402.48 111.25 402.03 111.25 401.55C111.25 401.03 111.123 400.563 110.87 400.15C110.616 399.737 110.28 399.41 109.86 399.17C109.446 398.93 109 398.81 108.52 398.81C107.986 398.81 107.513 398.94 107.1 399.2C106.686 399.46 106.36 399.8 106.12 400.22C105.88 400.633 105.76 401.077 105.76 401.55C105.76 402.05 105.88 402.51 106.12 402.93C106.366 403.343 106.696 403.673 107.11 403.92C107.523 404.167 107.986 404.29 108.5 404.29Z"
          fill="black"
        />
        <path
          d="M60.2096 411L63.0396 406.1C62.3663 406.227 61.7096 406.2 61.0696 406.02C60.4363 405.833 59.8663 405.53 59.3596 405.11C58.8529 404.683 58.4496 404.167 58.1496 403.56C57.8496 402.953 57.6996 402.287 57.6996 401.56C57.6996 400.9 57.8229 400.28 58.0696 399.7C58.3229 399.113 58.6696 398.6 59.1096 398.16C59.5496 397.713 60.0596 397.367 60.6396 397.12C61.2263 396.867 61.8529 396.74 62.5196 396.74C63.3929 396.74 64.1929 396.957 64.9196 397.39C65.6463 397.823 66.2263 398.407 66.6596 399.14C67.0929 399.867 67.3096 400.673 67.3096 401.56C67.3096 402.02 67.2529 402.44 67.1396 402.82C67.0329 403.2 66.8629 403.6 66.6296 404.02L62.6196 411H60.2096ZM62.4996 404.29C63.0329 404.29 63.5063 404.163 63.9196 403.91C64.3329 403.65 64.6563 403.313 64.8896 402.9C65.1296 402.48 65.2496 402.03 65.2496 401.55C65.2496 401.03 65.1229 400.563 64.8696 400.15C64.6163 399.737 64.2796 399.41 63.8596 399.17C63.4463 398.93 62.9996 398.81 62.5196 398.81C61.9863 398.81 61.5129 398.94 61.0996 399.2C60.6863 399.46 60.3596 399.8 60.1196 400.22C59.8796 400.633 59.7596 401.077 59.7596 401.55C59.7596 402.05 59.8796 402.51 60.1196 402.93C60.3663 403.343 60.6963 403.673 61.1096 403.92C61.5229 404.167 61.9863 404.29 62.4996 404.29Z"
          fill="black"
        />
        <path
          d="M86.8938 291V279.08H85.2238L85.7938 277H88.9738V291H86.8938Z"
          fill="black"
        />

        {/* Render the marks */}
        {injuries.map((injury, index) => {
          const symbolName = Object.keys(SYMBOLS).find(
            (key) => SYMBOLS[key as keyof typeof SYMBOLS] === injury.symbol,
          );
          const shouldBeHighlighted =
            injury.id === selectedInjuryPreview?.id ||
            (index + 1 === injuries.length && !selectedInjuryPreview);
          const isFilled =
            symbolName === "HAEMATOMA" || symbolName === "BRUISE";
          return (
            <g
              className="cursor-pointer transition-all"
              key={injury.id}
              transform={`translate(${injury.x - 5}, ${injury.y - 5}) scale${shouldBeHighlighted ? "(1.5)" : "(1)"}`}
              onClick={(e) => handleRemoveInjury(injury.id, e)}
            >
              <path
                d={injury.symbol}
                // d={SYMBOLS[injury.symbol as keyof typeof SYMBOLS]}
                stroke={shouldBeHighlighted ? "red" : "black"}
                strokeWidth={
                  symbolName === "HAEMATOMA" || symbolName === "BRUISE"
                    ? "0"
                    : "2"
                }
                fill={
                  isFilled ? (shouldBeHighlighted ? "red" : "black") : "none"
                }
              />
            </g>
          );
        })}
      </svg>
      <Form {...form}>
        <form onSubmit={form.handleSubmit(onSubmit)} className="self-end">
          <Button
            type="submit"
            disabled={!form.formState.isDirty}
            className="w-full sm:w-auto"
          >
            {form.formState.isSubmitting || updatePrfQuery.isPending ? (
              <>
                <Loader2 className="mr-2 h-4 w-4 animate-spin" /> Saving
              </>
            ) : (
              "Save"
            )}
          </Button>
        </form>
      </Form>
    </div>
  );
}
